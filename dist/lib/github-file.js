(self.webpackChunkoh_my_scripts=self.webpackChunkoh_my_scripts||[]).push([[610],{1543:function(t,e,i){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},n=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=this&&this.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,o=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s};Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendFilePreview=e.filePreviewNS=void 0;var a=i(1486),l=i(5008),c=i(8008),u=i(1603);e.filePreviewNS=function(t){return"iamogbz-gh-file-preview-"+t};var h=function(){function t(){this.frameTagName="iframe",this.toggleActionSource="source",this.toggleActionRender="render",this.frameStyle={background:"white",border:"none",display:"block",height:"100%",left:0,padding:0,position:"absolute",top:0,width:"100%",visibility:"hidden"}}return t.prototype.setup=function(){var t=this;l.onAjaxedPagesRaw((function(){(l.isCommit()||l.isPRFiles()||l.isSingleFile())&&t.initFeature()}))},t.prototype.pathToFile=function(t){return l.getUserRepo()+"/"+t},t.prototype.pathToBlob=function(t){return"https://raw.githubusercontent.com/"+this.pathToFile(t)},t.prototype.getFileContent=function(t){var e=this;return this.safeFetch(c.isAbsolutePath(t)?t:this.pathToBlob(t)).then((function(t){var e;return null===(e=t.text)||void 0===e?void 0:e.call(t)})).catch((function(i){if(console.info(i),!c.isAbsolutePath(t)){var r=s(t.split("/")),n=r[0],o=r.slice(1);return l.githubApi.v3(e.pathToApi(o.join("/"))+"?ref="+n).then((function(t){return atob(t.content)})).catch((function(t){console.error(t)}))}}))},t.prototype.safeFetch=function(t,e){return u.request(t,e).then((function(t){if(200!==t.status)throw new Error(t.status+" - "+t.statusText);return t}))},t.prototype.isSupportedFile=function(t){return this.fileTypes.has(c.getFileType(t))},t.prototype.pathToApi=function(t){return"repos/"+l.getUserRepo()+"/contents/"+t},t.prototype.selectButton=function(t){var e=a.selectDOM(".BtnGroup."+this.featureClass+" .BtnGroup-item.selected");e&&e.classList.remove("selected"),t.classList.add("selected"),t.blur()},t.prototype.showSource=function(t){var e=this;return function(i){var r=i.currentTarget;if(!r.disabled&&t){t.style.visibility="hidden";var n=t.parentElement;return null==n||n.style.removeProperty("overflow"),null==n||n.style.removeProperty("height"),null==n||n.style.removeProperty("max-height"),e.selectButton(r)}}},t.prototype.showRendered=function(t){var e=this;return function(i){var r=i.currentTarget,n=e.getContainerElement(t),o=e.getScrollHeight(t);if(n&&o&&!r.disabled){t.style.visibility="visible",n.style.overflow="hidden";var s=o+"px";return n.style.height=s,n.style.maxHeight=s,n.scrollLeft=0,e.selectButton(r)}}},t.prototype.getContainerElement=function(t){return t.parentElement},t.prototype.getScrollHeight=function(t){return t.contentWindow?t.contentWindow.document.body.scrollHeight+32:0},t.prototype.updateToggle=function(t,e){var i;t.disabled=!e,t.dataset.toggleAction===this.toggleActionRender&&(t.onclick=this.showRendered(e)),t.dataset.toggleAction===this.toggleActionSource&&(t.onclick=this.showSource(e)),t.setAttribute("aria-label",null!==(i=t.disabled?t.dataset.labelDisabled:t.dataset.labelEnabled)&&void 0!==i?i:"")},t.prototype.viewerButtonToggleGroup=function(t){var e=t.frameElem,i=t.isFileList,r=!e,n="HTML render toggle disabled",o=a.getTagNS("svg"),s=a.createElement({attributes:{"aria-current":"true",class:"btn btn-sm BtnGroup-item tooltipped tooltipped-"+(i?"w":"n")+" source "+(i?"js-source":"")+" "+(i?"":"selected"),"data-disable-with":"","data-label-disabled":n,"data-label-enabled":"Display the source "+(i?"diff":"blob"),"data-toggle-action":this.toggleActionSource,disabled:r},children:[{attributes:{"aria-hidden":"true",class:"octicon octicon-code",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{attributes:{d:"M4.72 3.22a.75.75 0 011.06 1.06L2.06 8l3.72 3.72a.75.75 0 11-1.06 1.06L.47 8.53a.75.75 0 010-1.06l4.25-4.25zm6.56 0a.75.75 0 10-1.06 1.06L13.94 8l-3.72 3.72a.75.75 0 101.06 1.06l4.25-4.25a.75.75 0 000-1.06l-4.25-4.25z","fill-rule":"evenodd"},tagName:"path",tagNS:o}],tagName:"svg",tagNS:o}],events:{click:this.showSource(e)},tagName:"button"}),l=a.createElement({attributes:{class:"btn btn-sm BtnGroup-item tooltipped tooltipped-"+(i?"w":"n")+" rendered "+(i?"js-rendered":""),disabled:r,"data-disable-with":"","data-label-disabled":n,"data-label-enabled":"Display the "+(i?"rich diff":"rendered blob"),"data-toggle-action":this.toggleActionRender},children:[{attributes:{"aria-hidden":"true",class:"octicon octicon-file",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{attributes:{d:"M3.75 1.5a.25.25 0 00-.25.25v11.5c0 .138.112.25.25.25h8.5a.25.25 0 00.25-.25V6H9.75A1.75 1.75 0 018 4.25V1.5H3.75zm5.75.56v2.19c0 .138.112.25.25.25h2.19L9.5 2.06zM2 1.75C2 .784 2.784 0 3.75 0h5.086c.464 0 .909.184 1.237.513l3.414 3.414c.329.328.513.773.513 1.237v8.086A1.75 1.75 0 0112.25 15h-8.5A1.75 1.75 0 012 13.25V1.75z","fill-rule":"evenodd"},tagName:"path",tagNS:o}],tagName:"svg",tagNS:o}],events:{click:this.showRendered(e)},tagName:"button"});return this.updateToggle(s,e),this.updateToggle(l,e),a.createElement({attributes:{class:"BtnGroup "+this.featureClass},children:[s,l],tagName:"span"})},t.prototype.frameElement=function(t){return a.createElement({attributes:r({class:this.featureClass,style:a.createElementStyle(this.frameStyle)},t),tagName:this.frameTagName})},t.prototype.addButtonsToFileHeaderActions=function(t,e){var i,r=this,n=".BtnGroup."+this.featureClass;a.selectExists(n,t)?null===(i=a.selectDOM(n,t))||void 0===i||i.childNodes.forEach((function(t){r.updateToggle(t,e)})):t.insertBefore(this.viewerButtonToggleGroup({frameElem:e,isFileList:l.isPRFiles()||l.isCommit()}),t.firstChild)},t.prototype.addFrameToFileBody=function(t,e,i){return n(this,void 0,void 0,(function(){var r,n,s,l,c;return o(this,(function(o){switch(o.label){case 0:return i&&!a.selectExists(".js-blob-wrapper",t)?[2,void 0]:(r=this.frameTagName+"."+this.featureClass,a.selectExists(r,t)?[2,a.selectDOM(r,t)]:(s=this.frameElement,c={src:"https://rawgit.com/"+this.pathToFile(e)},l=this.prepareHTML,[4,this.getFileContent(e)]));case 1:return[4,l.apply(this,[o.sent(),e])];case 2:return n=s.apply(this,[(c.srcDoc=o.sent(),c)]),t.style.position="relative",[2,t.appendChild(n)]}}))}))},t.prototype.extendHtmlFileDetailsElements=function(t){var e=this;return function(){return Promise.all(a.selectAll(".file.Details").map((function(i){return n(e,void 0,void 0,(function(){var e,r,n,s;return o(this,(function(o){switch(o.label){case 0:if(!(e=a.selectOrThrow(".file-header",i)).dataset.path)return[2];if(r=t+"/"+e.dataset.path,!this.isSupportedFile(r))return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.addFrameToFileBody(a.selectOrThrow(".js-file-content",i),r,!0)];case 2:return(n=o.sent())?(this.addButtonsToFileHeaderActions(a.selectOrThrow(".file-actions>.flex-items-stretch",e),n),[3,4]):[2];case 3:return s=o.sent(),console.error(s),[3,4];case 4:return[2]}}))}))})))}},t.prototype.initDiff=function(t){t&&a.observeEl("#files",this.extendHtmlFileDetailsElements(t),{childList:!0,subtree:!0})},t.prototype.initCommit=function(){this.initDiff(l.getCommitSha())},t.prototype.initPRFiles=function(){var t;this.initDiff(null===(t=a.selectDOM(".js-reviews-container #head_sha"))||void 0===t?void 0:t.value)},t.prototype.initSingleFile=function(){return n(this,void 0,void 0,(function(){var t,e,i;return o(this,(function(r){switch(r.label){case 0:return t=a.selectOrThrow(".Box.mt-3>.Box-header.py-2"),e=l.getRepoPath().replace("blob/",""),this.isSupportedFile(e)?[4,this.addFrameToFileBody(a.selectOrThrow(".Box.mt-3>.Box-body"),e,!1)]:[2];case 1:return(i=r.sent())?(this.addButtonsToFileHeaderActions(a.selectOrThrow(".d-flex",t),i),[2]):[2]}}))}))},t.prototype.initFeature=function(){return Promise.all([l.isPRFiles()&&this.initPRFiles(),l.isSingleFile()&&this.initSingleFile(),l.isCommit()&&this.initCommit()]).then((function(t){return t.some(Boolean)}))},t}();e.ExtendFilePreview=h}}]);