<html>

<head>
  <link rel="icon" href="./assets/monkey_128.png" />
  <style>
    html {
      --color-bg: white;
      --color-fg: black;
      --color-hl: cornflowerblue;

      height: 100vh;
      width: 100vw;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, Helvetica, sans-serif;
      font-size: 1.6em;
      line-height: 2em;
      color: var(--color-fg);
      background-color: var(--color-bg);
    }

    body {
      padding: 16px;
    }

    table {
      border-spacing: 1em;
    }

    th,
    td {
      text-align: center;
      padding: 0.4em 0.3em;
      user-select: none;
    }

    a {
      text-decoration: none;
      color: var(--color-fg);
      border: solid 2px;
      border-radius: 0.4em;
      padding: 0.4em;
      display: inline-block;
      width: 100%;

      &:hover {
        color: var(--color-hl);
      }
    }
  </style>
</head>

<body>
  <table>
    <thead>
      <tr>
        <th>Download Scripts</th>
        <th>¬†¬†¬†üìÉ</th>
      </tr>
    </thead>
    <tbody id="script-list">
    </tbody>
  </table>
  <script>
    const createElementFromInnerHtml = innerHTML => {
      const wrapper = document.createElement('div')
      wrapper.innerHTML = innerHTML;
      return wrapper.firstElementChild;
    }

    (async () => {
      const response = await fetch('https://api.github.com/repos/iamogbz/oh-my-scripts/contents/?ref=gh-pages');
      const data = await response.json();
      const scriptCollectionElem = document.getElementById('script-list');
      const fileExtType = '.user.js';
      const ghDataType = 'file'
      data
        .filter((f) => f.type === ghDataType && f.name.endsWith(fileExtType))
        .forEach((/** @type {{ name: string, download_url: string }} */ file) => {
          const fileBaseName = file.name.split('.')[0];
          const scriptItemElem = document.createElement('tr');

          const downloadItemElem = document.createElement('td');
          const downLinkTitle = `Download user script ${fileBaseName}`;
          downloadItemElem.appendChild(createElementFromInnerHtml(`<a title="${downLinkTitle}" href="${file.download_url}" target="_blank">${file.name} ‚Ü©Ô∏è</a>`));
          scriptItemElem.appendChild(downloadItemElem);

          const documentItemElem = document.createElement('td');
          const docLinkTitle = `Read documentation for ${fileBaseName}`;
          const readmeLink = `https://github.com/iamogbz/oh-my-scripts/tree/HEAD/scripts/${fileBaseName}/README.md`;
          documentItemElem.appendChild(createElementFromInnerHtml(`<a title="${docLinkTitle}" href="${readmeLink}" target="_blank">üëì</a>`));
          scriptItemElem.appendChild(documentItemElem);

          scriptCollectionElem.appendChild(scriptItemElem)
        })
    })()
  </script>

  <body>

</html>
