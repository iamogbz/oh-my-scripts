"use strict";(self.webpackChunkoh_my_scripts=self.webpackChunkoh_my_scripts||[]).push([[266],{6116:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.githubApi=void 0,e.getCleanPathname=h,e.getUserRepo=function(){return h().split("/").slice(0,2).join("/")},e.getRepoPath=g,e.getCommitSha=function(){const t=g().match(a);return t?t[0].split("/")[1]:void 0},e.getCompareHeadSha=function(){var t;return null===(t=function(){const t=g().match(r);return t?t.slice(1,3):void 0}())||void 0===t?void 0:t[1]},e.isCommit=function(){return new RegExp(`^${a}`).test(g())||new RegExp(`${c}/${a}`).test(g())},e.isCompare=function(){return new RegExp(r).test(g())},e.isSingleFile=function(){return/^blob\//.test(g())},e.isPRFiles=function(){return new RegExp(`${c}/files`).test(g())};const i=n(2944),o=n(8730),s="github.com"===location.hostname?"https://api.github.com/":`${location.origin}/api/v3/`,r="compare?/(.{1,40})\\.{3}(.{1,40})",a="commits?/[0-9a-f]{5,40}",c="^pull/\\d+",u=i.ns`GITHUB_TOKEN`;class l extends Error{constructor(...t){super(t.join("\n"))}}function p(){return window.localStorage.getItem(u)}function h(){return location.pathname.replace(/^[/]|[/]$/g,"")}function g(){return h().split("/").slice(2).join("/")}e.githubApi={v3:function(t,e={accept404:!1}){const n=p();return(0,o.request)(s+t,{headers:Object.assign({Accept:"application/vnd.github.v3+json","User-Agent":i.ns`user-script`},n?{Authorization:`token ${n}`}:{})}).then((function(t){var n;return null===(n=t.text)||void 0===n?void 0:n.call(t).then((function(n){const i=n.length>0?JSON.parse(n):{status:t.status};if(t.ok||!0===e.accept404&&404===t.status)return i;throw function(t){return"string"==typeof t.message&&t.message.includes("API rate limit exceeded")?new l("Rate limit exceeded.",p()?"It may be time for a walk!":"Set your token in the options or take a walk!"," 🍃 🌞"):"Bad credentials"===t.message?new l("The token seems to be incorrect or expired. Update it in the options."):new l("Unable to fetch.",p()?"Ensure that your token has access to this repo.":"Maybe adding a token in the options will fix this issue.",JSON.stringify(t,void 0,"\t"))}(i)}))}))}}}}]);