// ==UserScript==
// @name Fancy Cursor
// @description Fancy cursor for all elements
// @version 1.6.1
// @author iamogbz
// @homepage https://github.com/iamogbz/oh-my-scripts
// @supportURL https://github.com/iamogbz/oh-my-scripts/issues
// @match *://*/*
// @downloadURL https://github.com/iamogbz/oh-my-scripts/raw/1.6.1/fancy-cursor.user.js
// @icon https://github.com/iamogbz/oh-my-scripts/raw/main/assets/monkey_128.png
// @namespace iamogbz/oh-my-scripts
// @updateURL https://github.com/iamogbz/oh-my-scripts/raw/gh-pages/fancy-cursor.user.js
// ==/UserScript==

(()=>{"use strict";const e={CURSOR_ID:"fancy-cursor",OUTLINE_ID:"fancy-outline",BACKDROP_ID:"fancy-backdrop",SIZE:"2px",SPACE:"10px",Z_INDEX:Number.MAX_SAFE_INTEGER.toString()};!function(){const t=e=>{null==e||e.style.setProperty("cursor","none","important")},n={x:NaN,y:NaN},o=(()=>{const n=document.getElementById(e.CURSOR_ID)||document.createElement("div");return n.id||(n.style.backdropFilter=`blur(${e.SIZE})`,n.style.backgroundColor="rgba(255, 255, 255, 1)",n.style.borderRadius="50%",n.style.height=e.SIZE,n.style.mixBlendMode="difference",n.style.opacity="1",n.style.pointerEvents="none",n.style.position="fixed",n.style.touchAction="none",n.style.transform="translate(-50%, -50%)",n.style.transition="transform 0.1s ease",n.style.willChange="transform",n.style.userSelect="none",n.style.width=e.SIZE,n.style.zIndex=e.Z_INDEX,n.id||(n.id=e.CURSOR_ID,document.body.appendChild(n)),t(n)),n})();function l(e){if(!e)return!0;const t=e;return!(t.childElementCount>1)&&(t.childElementCount<1||Array.from(t.children||[]).every(l))}const r=(()=>{const n=document.createElement("div");return n.id||(n.style.borderRadius=e.SIZE,n.style.boxSizing="border-box",n.style.backgroundColor="rgba(255, 255, 255, 1)",n.style.mixBlendMode="difference",n.style.pointerEvents="none",n.style.position="fixed",n.style.transitionDuration="0.1s",n.style.transitionTimingFunction="ease",n.style.transitionProperty="height, width",n.style.willChange=n.style.transitionProperty,n.style.touchAction="none",n.style.userSelect="none",n.style.zIndex=e.Z_INDEX,n.id||(n.id=e.OUTLINE_ID,document.body.appendChild(n)),t(n)),n})(),i=r.cloneNode();i.id=e.BACKDROP_ID,document.body.appendChild(i);const s=s=>{n.x=s.clientX,n.y=s.clientY,o.style.left=`${n.x}px`,o.style.top=`${n.y}px`,(()=>{var o;const s=(()=>{if(Number.isNaN(n.x)||Number.isNaN(n.y)||null==n.x||null==n.y)return;const e=document.elementFromPoint(n.x,n.y)||document.querySelector(":hover")||document.activeElement;if(!e)return;const o=function(e,t){let n=e;for(;(null==n?void 0:n.parentNode)&&t(n.parentNode);)n=n.parentNode;return n}(e,(t=>{var n,o;return(null===(n=t.textContent)||void 0===n?void 0:n.trim())===(null===(o=e.textContent)||void 0===o?void 0:o.trim())&&l(t)}));return t(e),t(o),o})();if(r.style.zIndex=e.Z_INDEX,s&&l(s)){const t=s.getBoundingClientRect();r.style.left=`calc(${t.left}px - ${e.SPACE}/2)`,r.style.top=`calc(${t.top}px - ${e.SPACE}/2)`,r.style.width=`calc(${t.width}px + ${e.SPACE})`,r.style.height=`calc(${t.height}px + ${e.SPACE})`,r.style.borderRadius=e.SIZE}else r.style.left=`calc(${n.x}px - ${e.SPACE}/2)`,r.style.top=`calc(${n.y}px - ${e.SPACE}/2)`,r.style.width=e.SPACE,r.style.height=e.SPACE,r.style.borderRadius=e.SPACE;i.setAttribute("style",null!==(o=r.getAttribute("style"))&&void 0!==o?o:""),i.style.mixBlendMode="unset",i.style.zIndex=(-1*Number(e.Z_INDEX)).toString()})()};window.addEventListener("mousemove",s),window.addEventListener("touchstart",(e=>s(e.touches[0]))),t(document.documentElement),t(document.body)}()})();